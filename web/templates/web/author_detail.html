{% extends 'web/base.html' %}
{% load web_tags %}

{% block title %}{{ author }}{% endblock %}

{% block content %}
<h1>{{ author }}</h1>
{% if pseudonyms|length > 0 %}
    <h3>Další jména: 
        {% for p in pseudonyms %}
            {{ p }}{% if forloop.counter < pseudonyms|length %},{% endif %}
        {% endfor%}
    </h3>
{% endif %}
<p>
    <b>Datum narození:</b> {{author.date_of_birth|date:"d. m. Y"|default:'<i>neuvedeno</i>'}}<br/>
    <b>Místo narození:</b> {{author.place_of_birth|default:'<i>neuvedeno</i>'}}<br/>
    <b>Místo narození (pův. název):</b> {{author.place_of_birth_original_name|default:'<i>neuvedeno</i>'}}<br/>
    <b>Datum úmrtí:</b> {{author.date_of_death|date:"d. m. Y"|default:'<i>neuvedeno</i>'}}
    {% if age %} ({{age}} let) {% endif %}<br/>
    <b>Místo úmrtí:</b> {{author.place_of_death|default:'<i>neuvedeno</i>'}}<br/>
    <b>Místo úmrtí (pův. název):</b> {{author.place_of_death_original_name|default:'<i>neuvedeno</i>'}}<br/>
</p>
<p>
    <b>interní poznámka:</b><br/>{{ author.remark|default:'<i>prázdná</i>' }}
</p>
<p>
    <b>popis:</b><br/>{{ author.description|default:'<i>prázdný</i>' }}
</p>

<table id="booksTable" class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>id</th>
            <th>Název</th>
            <th>Rok</th>
            <th>Jméno autora</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for book in books %}
        <tr>
            <td>{{ book.id }}</td>
            <td>{{ book.title|safe }}</td>
            <td>{{ book.year| default:'<i>neznámý</i>' }}</td>
            <td>
                {% if book.authorships.all|length > 4%}
                    <i>{{ book.authorships.all|length }} autorů</i>
                {% elif book.authorships.all|length > 2%}
                    <i>{{ book.authorships.all|length }} autoři</i>
                {% else%}
                    {% for as in book.authorships.all %}
                        {% if forloop.counter > 1 %};{% endif %}
                        {{ as.person.surname }}&nbsp;{{ as.person.firstname|replace_spaces|safe }}
                    {% empty %}
                        <i>neznámý autor</i>
                    {% endfor %}
                {% endif %}
            </td>
            <td><a href="{% url 'book_detail' id=book.id %}">detail</a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready( function () {
    $('#booksTable').DataTable({
        order : [[1, 'asc'], [2, 'asc']],
        pageLength: 25,
        columnDefs: [
            { "orderable": false, "targets": -1 },
        ],
        language: dataTableCS,
    });
} );
</script>
{% endblock %}