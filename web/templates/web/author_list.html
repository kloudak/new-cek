{% extends 'web/base.html' %}

{% block title %}Seznam autorů a autorek{% endblock %}

{% block content %}
<h2>Autoři a autorky</h2>
<table id="authorsTable" class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>id</th>
            <th>Příjmení</th>
            <th>Jméno</th>
            <th>Narození</th>
            <th>Úmrtí</th>
            <th>Pseudonym autora</th>
            <th>Knih</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        {% for person in persons %}
        <tr>
            <td>{{ person.id }}</td>
            <td>{{ person.surname }}</td>
            <td>{{ person.firstname }}</td>
            <td>{{ person.date_of_birth|date:"Y-m-d" }}</td>
            <td>{{ person.date_of_death|date:"Y-m-d" }}</td>
            <td>
                {% if person.pseudonym_for %}
                    {{ person.pseudonym_for.surname  }}
                    {{ person.pseudonym_for.firstname  }}
                {% endif%}
            </td>
            <td>{{ person.num_books }}</td>
            <td><a href="{% url 'author_detail' id=person.id %}">edit</a></td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready( function () {
    $('#authorsTable').DataTable({
        order : [[1, 'asc'], [2, 'asc']],
        pageLength: 25,
        columnDefs: [
            { "orderable": false, "targets": -1 },
            {
                targets: [3,4],
                render: function (data, type, row) {
                    if (type === 'display' || type === 'filter') {
                        if(data == '') {
                            return '';
                        }
                        var dateSplit = data.split('-'); // Split the date by '-'
                        return dateSplit[2] + '.&nbsp;' + dateSplit[1] + '.&nbsp;' + dateSplit[0]; // Reformat to DD.MM.YYYY
                    }
                    return data; // Return unmodified data for other data types
                }
            },
        ],
        language: dataTableCS,
    });
} );
</script>
{% endblock %}
